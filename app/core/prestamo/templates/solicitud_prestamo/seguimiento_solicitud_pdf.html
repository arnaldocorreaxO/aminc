<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Seguimiento de Solicitud N° {{ solicitud.nro_solicitud }}</title>
    <meta name="description"
          content="Seguimiento de la solicitud de préstamo N° {{ solicitud.nro_solicitud }} generado el {{ now|date:'d/m/Y H:i' }}"/>
    <meta name="keywords"
          content="seguimiento, solicitud, préstamo, {{ empresa.denominacion }}"/>
    <style>
    @page {
            size: A4;
            margin: 1cm 2cm 2cm 2cm; /* top, right, bottom, left */
        }
    body { font-family: Arial, sans-serif; font-size: 12px; }
    .encabezado { text-align: center; margin-bottom: 20px; }
    .tabla { width: 100%; border-collapse: collapse; }
    .tabla th, .tabla td { border: 1px solid #ccc; padding: 6px; }
    .firma { margin-top: 40px; text-align: right; }
    .img-logo {
        width: 100%;
        height: auto;
        display: block;
        margin: 0;
        padding: 0;
    }
    /* Moved inline styles to classes */
    .header-table { width: 100%; margin-bottom: 10px; font-size: 12px; }
    .col-logo { width: 20%; vertical-align: top; }
    .col-center { width: 80%; text-align: center; }
    .datos-solicitud { margin-bottom: 20px; }
    .datos-table { width: 100%; font-size: 12px; border-collapse: collapse; }
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    </style>
  </head>
  <body>
    <!-- Encabezado institucional -->
    <table class="header-table">
      <tr>
        <td class="col-logo">
          <img src="{{ empresa.get_image }}"
               class="img-logo"
               width="150"
               height="75"
               alt="{{ empresa.denominacion }} logo"/>
        </td>
        <td class="col-center">
          <strong>{{ empresa.denominacion }}</strong>
          <br />
          {{ empresa.direccion }}
          <br />
          Teléfono: {{ empresa.telefono }}
        </td>
      </tr>
    </table>
    <!-- Título principal -->
    <div class="encabezado">
      <h3>Seguimiento de Solicitud N° {{ solicitud.nro_solicitud }}</h3>
      <p>Fecha de generación: {{ now|date:"d/m/Y H:i" }}</p>
    </div>
    <div class="datos-solicitud">
      <table class="datos-table">
        <tr>
          <td>
            <strong>Cliente:</strong> {{ solicitud.cliente.persona }}
          </td>
          <td>
            <strong>Tipo de Préstamo:</strong> {{ solicitud.tipo_prestamo.denominacion }}
          </td>
        </tr>
        <tr>
          <td>
            <strong>Monto Solicitado:</strong> {{ solicitud.monto_solicitado|floatformat:0 }}
          </td>
          <td>
            <strong>Plazo (meses):</strong> {{ solicitud.plazo_meses }}
          </td>
        </tr>
        <tr>
          <td>
            <strong>Cantidad de Cuotas:</strong> {{ solicitud.cant_cuota }}
          </td>
          <td>
            <strong>Situación Actual:</strong> {{ solicitud.situacion_solicitud.denominacion }}
          </td>
        </tr>
      </table>
    </div>
    <table class="tabla">
      <thead>
        <tr>
          <th>Fecha</th>
          <th>Situación</th>
          <th>Comentario</th>
          <th>Acta</th>
          <th>Resolución</th>
          <th>Monto Aprobado</th>
        </tr>
      </thead>
      <tbody>
        {% for s in situaciones %}
          <tr>
            <td>{{ s.fecha|date:"d/m/Y" }}</td>
            <td>{{ s.situacion_solicitud.denominacion }}</td>
            <td>{{ s.comentario }}</td>
            <td>
              {{ s.nro_acta|default:"-" }}
              <br />
              {{ s.fec_acta|date:"d/m/Y" }}
            </td>
            <td>{{ s.nro_resolucion|default:"-" }}</td>
            <td class="text-right">{{ s.monto_aprobado|floatformat:0 }}</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="6" class="text-center">No hay registros de seguimiento.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <div class="firma">
      <p>__________________________</p>
      <p>Responsable de Seguimiento</p>
    </div>
  </body>
</html>
